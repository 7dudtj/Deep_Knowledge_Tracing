cuda
2022-11-19 08:23:04,519 - root - INFO - Task Started
2022-11-19 08:23:04,519 - root - INFO - [1/1] Data Preparing - Start
> /opt/ml/input/code/lightgcn/lightgcn/datasets.py(52)separate_data()
-> x_train, x_valid, y_train, y_valid = train_test_split(train_data.drop(['answerCode'],axis=1), train_data['answerCode'], test_size=0.2, random_state=42)
        userID assessmentItemID      testId  answerCode            Timestamp  KnowledgeTag
0            0       A060001001  A060000001           1  2020-03-24 00:17:11          7224
1            0       A060001002  A060000001           1  2020-03-24 00:17:14          7225
2            0       A060001003  A060000001           1  2020-03-24 00:17:22          7225
3            0       A060001004  A060000001           1  2020-03-24 00:17:29          7225
4            0       A060001005  A060000001           1  2020-03-24 00:17:36          7225
...        ...              ...         ...         ...                  ...           ...
259364    7439       A040197005  A040000197           0  2020-08-21 07:39:40          2132
259365    7439       A040197006  A040000197           1  2020-08-21 07:39:45          2132
259366    7439       A040130001  A040000130           0  2020-10-14 23:07:23          8832
259367    7439       A040130002  A040000130           1  2020-10-14 23:07:41          8832
259368    7439       A040130003  A040000130           1  2020-10-14 23:08:02          8244
[2475230 rows x 6 columns]
        userID assessmentItemID      testId            Timestamp  KnowledgeTag
0            0       A060001001  A060000001  2020-03-24 00:17:11          7224
1            0       A060001002  A060000001  2020-03-24 00:17:14          7225
2            0       A060001003  A060000001  2020-03-24 00:17:22          7225
3            0       A060001004  A060000001  2020-03-24 00:17:29          7225
4            0       A060001005  A060000001  2020-03-24 00:17:36          7225
...        ...              ...         ...                  ...           ...
259364    7439       A040197005  A040000197  2020-08-21 07:39:40          2132
259365    7439       A040197006  A040000197  2020-08-21 07:39:45          2132
259366    7439       A040130001  A040000130  2020-10-14 23:07:23          8832
259367    7439       A040130002  A040000130  2020-10-14 23:07:41          8832
259368    7439       A040130003  A040000130  2020-10-14 23:08:02          8244
[2475230 rows x 5 columns]
0         1
1         1
2         1
3         1
4         1
         ..
259364    0
259365    1
259366    0
259367    1
259368    1
Name: answerCode, Length: 2475230, dtype: int64
         userID assessmentItemID      testId            Timestamp  KnowledgeTag
112354     1503       A040113003  A040000113  2020-09-14 11:26:17          2098
1122716    1723       A070131008  A070000131  2020-11-08 18:03:10          9066
1796946    3358       A030175001  A030000175  2020-10-15 00:16:30          1931
2265883    7394       A030185003  A030000185  2020-10-26 11:45:38          1963
2047080    4426       A030066001  A030000066  2020-06-09 04:14:55           436
...         ...              ...         ...                  ...           ...
112904      147       A010007003  A010000007  2020-03-03 12:10:27          5814
1733684    3147       A010148004  A010000148  2020-10-18 05:27:01          7804
138462     1828       A070113005  A070000113  2020-11-30 08:15:26          9052
8904         64       A020098001  A020000098  2020-09-01 08:48:24          8027
2265063    7340       A050153005  A050000153  2020-10-23 08:09:22           446
[1980184 rows x 5 columns]
*** NameError: name 'x_Valid' is not defined
         userID assessmentItemID      testId            Timestamp  KnowledgeTag
2232530    6333       A020193001  A020000193  2020-10-16 11:34:35          8094
52291        70       A030117001  A030000117  2020-09-07 08:11:42           547
359221      486       A030135002  A030000135  2020-09-27 02:55:44          7690
113060      147       A070025008  A070000025  2020-03-30 21:49:43          5619
754103     1093       A030001003  A030000001  2020-03-25 13:17:05           307
...         ...              ...         ...                  ...           ...
1934473    3877       A040174005  A040000174  2020-10-23 03:20:25          2123
418921      586       A050024006  A050000024  2020-07-09 00:09:28          2625
657532      939       A090034004  A090000034  2020-12-28 04:29:12         10610
1627901    2852       A030183004  A030000183  2020-07-28 09:40:28          1962
1502178    2539       A050035003  A050000035  2020-04-27 02:32:32          3693
[495046 rows x 5 columns]
         userID assessmentItemID      testId            Timestamp  KnowledgeTag  answerCode
112354     1503       A040113003  A040000113  2020-09-14 11:26:17          2098           0
1122716    1723       A070131008  A070000131  2020-11-08 18:03:10          9066           0
1796946    3358       A030175001  A030000175  2020-10-15 00:16:30          1931           1
2265883    7394       A030185003  A030000185  2020-10-26 11:45:38          1963           0
2047080    4426       A030066001  A030000066  2020-06-09 04:14:55           436           1
...         ...              ...         ...                  ...           ...         ...
112904      147       A010007003  A010000007  2020-03-03 12:10:27          5814           1
1733684    3147       A010148004  A010000148  2020-10-18 05:27:01          7804           0
138462     1828       A070113005  A070000113  2020-11-30 08:15:26          9052           0
8904         64       A020098001  A020000098  2020-09-01 08:48:24          8027           1
2265063    7340       A050153005  A050000153  2020-10-23 08:09:22           446           0
[1980184 rows x 6 columns]
         userID assessmentItemID      testId            Timestamp  KnowledgeTag  answerCode
2232530    6333       A020193001  A020000193  2020-10-16 11:34:35          8094           1
52291        70       A030117001  A030000117  2020-09-07 08:11:42           547           1
359221      486       A030135002  A030000135  2020-09-27 02:55:44          7690           1
113060      147       A070025008  A070000025  2020-03-30 21:49:43          5619           1
754103     1093       A030001003  A030000001  2020-03-25 13:17:05           307           0
...         ...              ...         ...                  ...           ...         ...
1934473    3877       A040174005  A040000174  2020-10-23 03:20:25          2123           1
418921      586       A050024006  A050000024  2020-07-09 00:09:28          2625           0
657532      939       A090034004  A090000034  2020-12-28 04:29:12         10610           0
1627901    2852       A030183004  A030000183  2020-07-28 09:40:28          1962           1
1502178    2539       A050035003  A050000035  2020-04-27 02:32:32          3693           1
[495046 rows x 6 columns]
         userID assessmentItemID      testId            Timestamp  KnowledgeTag  answerCode
112354     1503       A040113003  A040000113  2020-09-14 11:26:17          2098           0
1122716    1723       A070131008  A070000131  2020-11-08 18:03:10          9066           0
1796946    3358       A030175001  A030000175  2020-10-15 00:16:30          1931           1
2265883    7394       A030185003  A030000185  2020-10-26 11:45:38          1963           0
2047080    4426       A030066001  A030000066  2020-06-09 04:14:55           436           1
...         ...              ...         ...                  ...           ...         ...
112904      147       A010007003  A010000007  2020-03-03 12:10:27          5814           1
1733684    3147       A010148004  A010000148  2020-10-18 05:27:01          7804           0
138462     1828       A070113005  A070000113  2020-11-30 08:15:26          9052           0
8904         64       A020098001  A020000098  2020-09-01 08:48:24          8027           1
2265063    7340       A050153005  A050000153  2020-10-23 08:09:22           446           0
[1980184 rows x 6 columns]
        userID assessmentItemID      testId  answerCode            Timestamp  KnowledgeTag
1034         3       A050133007  A050000133          -1  2020-10-26 13:13:11          5289
1704         4       A070146007  A070000146          -1  2020-12-27 02:47:31          9080
3020        13       A070111007  A070000111          -1  2020-12-27 04:35:01          9660
4279        17       A090064005  A090000064          -1  2020-10-30 05:47:22          2611
4665        26       A060135006  A060000135          -1  2020-10-23 11:44:01          1422
...        ...              ...         ...         ...                  ...           ...
259312    7395       A040122004  A040000122          -1  2020-09-08 02:05:18          2102
259326    7404       A030111004  A030000111          -1  2020-10-13 09:47:31          7636
259340    7416       A050193003  A050000193          -1  2020-10-04 02:44:17         10402
259354    7417       A050193003  A050000193          -1  2020-09-06 13:08:54         10402
259369    7439       A040130004  A040000130          -1  2020-10-14 23:09:31          8244
[744 rows x 6 columns]
         userID assessmentItemID      testId            Timestamp  KnowledgeTag  answerCode
2232530    6333       A020193001  A020000193  2020-10-16 11:34:35          8094           1
52291        70       A030117001  A030000117  2020-09-07 08:11:42           547           1
359221      486       A030135002  A030000135  2020-09-27 02:55:44          7690           1
113060      147       A070025008  A070000025  2020-03-30 21:49:43          5619           1
754103     1093       A030001003  A030000001  2020-03-25 13:17:05           307           0
...         ...              ...         ...                  ...           ...         ...
1934473    3877       A040174005  A040000174  2020-10-23 03:20:25          2123           1
418921      586       A050024006  A050000024  2020-07-09 00:09:28          2625           0
657532      939       A090034004  A090000034  2020-12-28 04:29:12         10610           0
1627901    2852       A030183004  A030000183  2020-07-28 09:40:28          1962           1
1502178    2539       A050035003  A050000035  2020-04-27 02:32:32          3693           1
[495046 rows x 6 columns]
         userID assessmentItemID      testId            Timestamp  KnowledgeTag  answerCode
112354     1503       A040113003  A040000113  2020-09-14 11:26:17          2098           0
1122716    1723       A070131008  A070000131  2020-11-08 18:03:10          9066           0
1796946    3358       A030175001  A030000175  2020-10-15 00:16:30          1931           1
2265883    7394       A030185003  A030000185  2020-10-26 11:45:38          1963           0
2047080    4426       A030066001  A030000066  2020-06-09 04:14:55           436           1
...         ...              ...         ...                  ...           ...         ...
112904      147       A010007003  A010000007  2020-03-03 12:10:27          5814           1
1733684    3147       A010148004  A010000148  2020-10-18 05:27:01          7804           0
138462     1828       A070113005  A070000113  2020-11-30 08:15:26          9052           0
8904         64       A020098001  A020000098  2020-09-01 08:48:24          8027           1
2265063    7340       A050153005  A050000153  2020-10-23 08:09:22           446           0
[1980184 rows x 6 columns]
Traceback (most recent call last):
  File "/opt/ml/input/code/lightgcn/train.py", line 63, in <module>
    main()
  File "/opt/ml/input/code/lightgcn/train.py", line 47, in main
    train(
  File "/opt/ml/input/code/lightgcn/lightgcn/models.py", line 66, in train
    acc = accuracy_score(valid_data["label"], prob > 0.5)
  File "/opt/conda/envs/lgcn/lib/python3.10/site-packages/sklearn/metrics/_classification.py", line 211, in accuracy_score
    y_type, y_true, y_pred = _check_targets(y_true, y_pred)
  File "/opt/conda/envs/lgcn/lib/python3.10/site-packages/sklearn/metrics/_classification.py", line 85, in _check_targets
    type_true = type_of_target(y_true, input_name="y_true")
  File "/opt/conda/envs/lgcn/lib/python3.10/site-packages/sklearn/utils/multiclass.py", line 286, in type_of_target
    if is_multilabel(y):
  File "/opt/conda/envs/lgcn/lib/python3.10/site-packages/sklearn/utils/multiclass.py", line 152, in is_multilabel
    y = np.asarray(y)
  File "/opt/conda/envs/lgcn/lib/python3.10/site-packages/torch/_tensor.py", line 732, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2022-11-19 08:27:30,624 - data - INFO - Train Dataset Info
2022-11-19 08:27:30,625 - data - INFO -  * Num. Users    : 7442
2022-11-19 08:27:30,625 - data - INFO -  * Max. UserID   : 7441
2022-11-19 08:27:30,626 - data - INFO -  * Num. Items    : 9454
2022-11-19 08:27:30,626 - data - INFO -  * Num. Records  : 1980184
2022-11-19 08:27:30,626 - data - INFO - Test Dataset Info
2022-11-19 08:27:30,627 - data - INFO -  * Num. Users    : 744
2022-11-19 08:27:30,627 - data - INFO -  * Max. UserID   : 7439
2022-11-19 08:27:30,627 - data - INFO -  * Num. Items    : 452
2022-11-19 08:27:30,627 - data - INFO -  * Num. Records  : 744
2022-11-19 08:27:30,796 - data - INFO - Valid Dataset Info
2022-11-19 08:27:30,797 - data - INFO -  * Num. Users    : 7434
2022-11-19 08:27:30,797 - data - INFO -  * Max. UserID   : 7441
2022-11-19 08:27:30,798 - data - INFO -  * Num. Items    : 9454
2022-11-19 08:27:30,798 - data - INFO -  * Num. Records  : 495046
2022-11-19 08:27:30,905 - root - INFO - [1/1] Data Preparing - Done
2022-11-19 08:27:30,905 - root - INFO - [2/2] Model Building - Start
2022-11-19 08:27:30,915 - build - INFO - No load model
2022-11-19 08:27:30,917 - root - INFO - [2/2] Model Building - Done
2022-11-19 08:27:30,917 - root - INFO - [3/3] Model Training - Start
2022-11-19 08:27:30,918 - train - INFO - Training Started : n_epoch=800